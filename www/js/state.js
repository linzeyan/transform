/**
 * Shared application state
 */

// Global state object
export const state = {
    currentTool: 'format',
    wasmReady: false,
    uuidUppercase: false,
    currentUUIDs: {},
    currentBrowserFilter: '',
    currentOSFilter: '',
    currentUserAgents: [],
    coderMode: 'encode',
    selectedDecoder: '',
    hashUppercase: false,
    hashEncoding: 'base16',
    hashUseHmac: false,
    hashHmacSecret: '',
    lastEncodeResults: null,
    lastHashResults: null,
    encodeCaseMap: { base16: true, base32: true },
    coder: {
        inputMode: 'text',
        fileBytes: null,
        fileName: '',
        fileSize: 0,
        decodedBytes: null,
        decodedFileName: '',
    },
    currentPairTool: null,
    pairSyncing: false,
    pairLastSource: 'input',
    urlQueryParams: [],
    urlBase: '',
    urlHash: '',
    urlHadQuestionMark: false,
    // Image converter keeps the selected file and last conversion handy for downloads.
    image: {
        fileBytes: null,
        fileName: '',
        fileSize: 0,
        detectedFormat: '',
        targetFormat: 'webp',
        previewUrl: '',
        result: null,
        optionsByFormat: {
            jpg: { quality: 85 },
            png: { compression: 6 },
            webp: {},
            avif: { quality: 80, speed: 4, lossless: false },
        },
    },
    numberSyncing: false,
    unitSyncing: false,
    randomIncludeDigits: true,
    randomAllowLeadingZero: true,
    randomLength: 24,
    randomCount: 5,
    randomIncludeLower: false,
    randomIncludeUpper: false,
    randomExclude: '',
    randomDigitMin: '',
    randomDigitMax: '',
    randomMinDigits: 0,
    randomMinLower: 0,
    randomMinUpper: 0,
    randomMinSymbols: 0,
    randomSymbols: new Set(),
    randomResults: [],
    // QR generator caches the last preview so downloads work when returning to the tab.
    qr: {
        mode: 'otp',
        format: 'png',
        otpAccount: '',
        otpSecret: '',
        otpIssuer: '',
        otpAlgorithm: 'SHA1',
        otpPeriod: 30,
        otpDigits: 6,
        wifiType: 'WPA',
        wifiPass: '',
        wifiSsid: '',
        customString: '',
        lastResult: null,
    },
    sshType: 'ed25519',
    sshBits: 4096,
    sshComment: '',
    sshFormat: 'openssh',
    sshKdf: 16,
    sshResident: false,
    sshVerify: false,
    sshLastKey: null,
    timestampUpdating: false,
    timestampActiveField: null,
    totpSecret: '',
    totpAlgorithm: 'SHA256',
    totpPeriod: 30,
    totpDigits: 6,
    totpTimer: null,
    dataRows: 5,
    diffTimer: null,
    dataOverrides: {},
    dataTables: [],
    dataSchemaTimer: null,
    dataDirty: false,
    formatKey: null,
    fingerprintFacts: [],
    kdf: {
        active: 'bcrypt',
        bcryptCost: 10,
        argonTime: 3,
        argonMem: 65536,
        argonParallelism: 1,
        argonType: 'argon2id',
        argonHashLen: 32,
        salts: {},
    },
    certTimer: null,
    certResults: [],
    crypto: {
        algorithm: 'aes-256-gcm',
        inputMode: 'text',
        fileBytes: null,
        fileName: '',
        fileSize: 0,
    },
};

// Global elements cache
export const elements = {};

// Global timers
export let coderTimer = null;
export let convertTimer = null;
